-- 만원 단위의 가격대 별로 상품 개수 출력
-- 가격대 정보는 각 구간의 최소금액으로 표시
-- 가격대 기준으로 오름차순

# SELECT PRICE_GROUP
#      , COUNT(*)
# FROM (
#     SELECT CASE WHEN PRICE < 10000 THEN 0
#             WHEN PRICE BETWEEN 10000 AND 19999 THEN 10000
#             WHEN PRICE BETWEEN 20000 AND 29999 THEN 20000
#             WHEN PRICE BETWEEN 30000 AND 39999 THEN 30000
#             WHEN PRICE BETWEEN 40000 AND 49999 THEN 40000
#             WHEN PRICE BETWEEN 50000 AND 59999 THEN 50000
#             WHEN PRICE BETWEEN 60000 AND 69999 THEN 60000
#             WHEN PRICE BETWEEN 70000 AND 79999 THEN 70000
#             WHEN PRICE BETWEEN 80000 AND 89999 THEN 80000
#             END AS PRICE_GROUP
#     FROM PRODUCT
#     ) AS PRICE_TABLE
# GROUP BY PRICE_GROUP
# ORDER BY PRICE_GROUP

SELECT TRUNCATE(PRICE, -4) AS PRICE_GROUP
     , COUNT(*) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP